<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT5~3 Quiz</title>
    <style>
body {
  background-image: url("{{ url_for('static', filename='images/i.png') }}");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  min-height: 100vh;
  margin: 0;
  padding: 20px;
  font-family: 'Comic Sans MS', 'Noto Sans JP', cursive;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}

.quiz-container {
  background: #fff8dc;
  border: 5px solid black;
  border-radius: 20px;
  padding: 30px;
  max-width: 90%;
  box-shadow: 6px 6px 0 #000;
  position: relative;
  z-index: 1;
}

.question-counter {
  font-weight: bold;
  color: #ff4444;
  font-size: 1.2em;
  text-shadow: 1px 1px white;
  margin-bottom: 10px;
}

.option {
  background-color: #ffefc3;
  border: 3px solid black;
  border-radius: 10px;
  padding: 12px;
  margin: 8px 0;
  font-size: 16px;
  cursor: pointer;
  width: 100%;
  box-shadow: 3px 3px 0 black;
  transition: transform 0.2s, background-color 0.2s;
}

.option:hover {
  transform: scale(1.05);
  background-color: #ffe28a;
}

.correct {
  background-color: #4CAF50 !important;
  color: white;
}

.incorrect {
  background-color: #f44336 !important;
  color: white;
}

.next-btn, #back-btn {
  border: 3px solid black;
  border-radius: 12px;
  padding: 12px 20px;
  font-size: 16px;
  font-weight: bold;
  font-family: 'Comic Sans MS', cursive;
  box-shadow: 3px 3px 0 black;
  transition: transform 0.2s;
  position: fixed;
  z-index: 100;
}

.next-btn {
  background-color: #4CAF50;
  color: white;
  right: 20px;
  bottom: 20px;
  display: none; /* ÂàùÊúü„ÅØÈùûË°®Á§∫„Å´„Åó„Å¶JS„ÅßË°®Á§∫ */
}

#back-btn {
  background-color: #2196F3;
  color: white;
  left: 20px;
  bottom: 20px;
}

/* „Çπ„Éû„ÉõÁî®„É¨„Çπ„Éù„É≥„Ç∑„Éñ */
@media (max-width: 768px) {
  .quiz-container {
    width: 95%;
    padding: 20px;
  }

  .option {
    font-size: 14px;
  }

  .next-btn, #back-btn {
    padding: 10px 14px;
    font-size: 14px;
  }
}
#question-img {
  display: block;
  margin: 20px auto;
  max-width: 100%;
  height: auto;
  border-radius: 10px;
}
    </style>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>
    <div class="quiz-container">
        <div class="question-counter" id="question-counter">Question 1 of 10</div>
        <p id="question"></p>
        <img id="question-img" src="" alt="Question Image">
        <div id="options"></div>
        <div class="buttons-container">
            <button onclick="nextQuestion()" class="next-btn">Next</button>
            <button id="back-btn" onclick="window.location.href='/home#jlptlo'">Back to Main Menu</button>
        </div>
        <div id="ghibli-results" class="ghibli-results" style="display:none;">
            <div class="ghibli-clouds"></div>
            <h2 class="ghibli-title">Your Quiz Results</h2>
            <div class="ghibli-character" id="ghibli-char">üêâ</div>
            <div class="ghibli-score" id="ghibli-score">0/10</div>
            <div class="ghibli-message" id="ghibli-message"></div>
            
        </div>
    </div>

    <script>
        const questions = [
        {
                question: "1. „Åì„Çå„ÅØÔºàÔºøÔºâ„Åß„Åô„ÄÇ",
                options: ["1. Áä¨", "2. Áå´", "3. Ëªä", "4. Ëä±"],
                answer: "2. Áå´",
                image: "{{ url_for('static', filename='images/cat.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "2. „Åç„ÅÆ„ÅÜ„Çπ„Éº„Éë„Éº„Åß„Åø„ÅöÔºàÔºøÔºâË≤∑„ÅÑ„Åæ„Åó„Åü„ÄÇ",
                options: ["1. „Å®","2. „Çí", "3. „ÇÇ", "4. „Åå"],
                answer: "2. „Çí",
                image: "{{ url_for('static', filename='images/water.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "3. „Åì„ÅÆ„É¨„Çπ„Éà„É©„É≥„ÅÆ„Éë„É≥„ÅØÔºàÔºøÔºâ„Åä„ÅÑ„Åó„ÅÑ„Åß„Åô„ÄÇ",
                options: ["1. „Å®„Å¶„ÇÇ", "2. „ÅÇ„Åæ„Çä", "3. „Åü„Åè„Åï„Çì", "4. „Å†„Åë„Å©"],
                answer: "1. „Å®„Å¶„ÇÇ",
                image: "{{ url_for('static', filename='images/bread.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "4. ÈõªÊ∞ó„ÇíÔºàÔºøÔºâ„Åæ„Åæ„ÄÅÂá∫„Åã„Åë„Åæ„Åó„Åü„ÄÇ",
                options: ["1. „Å§„Åë„Çã", "2. „Å§„Åë„Å¶", "3. „Å§„Åë„Åü", "4. „Å§„Åë„Å¶„ÅÑ„Çã"],
                answer: "3. „Å§„Åë„Åü",
                image: "{{ url_for('static', filename='images/lights.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "5. „Çè„Åü„Åó„ÅØÁóÖÊ∞óÔºàÔºøÔºâÂ≠¶Ê†°„Çí„ÇÑ„Åô„Çì„Å†„ÄÇ",
                options: ["1. „Åß", "2. „Å´", "3. „Çí", "4. „Åã„Çâ"],
                answer: "1. „Åß",
                image: "{{ url_for('static', filename='images/sick.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "6. ÊòéÊó•„ÅØÈõ®„ÅåÔºàÔºøÔºâ„Çâ„Åó„ÅÑ„Åß„Åô„ÄÇ",
                options: ["1. Èôç„Çã", "2. Èôç„Å£„Å¶", "3. Èôç„Å£„Åü", "4. Èôç„Çä"],
                answer: "1. Èôç„Çã",
                image: "{{ url_for('static', filename='images/rain.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "7. „Åì„ÅÆÂïèÈ°å„ÅØÂ≠ê‰æõÔºàÔºøÔºâ„ÇÄ„Åö„Åã„Åó„ÅÑ„ÄÇ",
                options: ["1. „Å´„Å®„Å£„Å¶", "2. „Å´„Çà„Å£„Å¶", "3. „Å´„Å§„ÅÑ„Å¶", "4. „Å´ÂØæ„Åó„Å¶"],
                answer: "1. „Å´„Å®„Å£„Å¶",
                image: "{{ url_for('static', filename='images/difficult.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "8. „Ç≥„É≠„ÉäÊµÅË°å„ÅÆÂΩ±Èüø„Å´ÔºàÔºøÔºâ„ÄÅ„É¨„Çπ„Éà„É©„É≥„ÅØ‰ºëÊ•≠„Åó„Åü„ÄÇ",
                options: ["1. „Å†„Åë„Å©", "2. „Å™„ÅÆ„Åß", "3. „Åó„Åã„Åó", "4. „Çà„Å£„Å¶"],
                answer: "4. „Çà„Å£„Å¶",
                image: "{{ url_for('static', filename='images/covid.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "9. „Ç™„É™„É≥„Éî„ÉÉ„ÇØ„ÅØÔºîÂπ¥ÔºàÔºøÔºâ„Å´„ÄÅÈñãÂÇ¨„Åï„Çå„Çã„ÄÇ",
                options: ["1. „Å†„Åë", "2. „Åª„Å©", "3. „Åî„Å®", "4. „Åæ„Åü"],
                answer: "3. „Åî„Å®",
                image: "{{ url_for('static', filename='images/olympic.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "10. ‰∏ÄÁû¨ÔºàÔºøÔºâ„ÇíÂ§±„ÅÑ„Åã„Åë„Åü",
                options: ["1. Êõ∏Êñé", "2. ÊÑèË≠ò", "3. ÂïÜÊ•≠", "4. ‰øÆÁêÜ"],
                answer: "2. ÊÑèË≠ò",
                image: "{{ url_for('static', filename='images/life.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
        ];


        let currentQuestionIndex = 0;
        let score = 0;
        let wrongAnswersCount = 0;
        let selected = false;
        
        function loadQuestion() {
            selected = false; // Reset selected status for new question
            const questionData = questions[currentQuestionIndex];
            document.getElementById("question").innerText = questionData.question;
            
            // Update question counter
            document.getElementById("question-counter").innerText = 
                `Question ${currentQuestionIndex + 1} of ${questions.length}`;
            
            const imgElement = document.getElementById("question-img");
            imgElement.src = questionData.image;
            imgElement.style = questionData.imageStyle || ""; 
            
            let optionsHtml = "";
            questionData.options.forEach(option => {
                optionsHtml += `<button class='option' onclick='checkAnswer(this, "${option}")'>${option}</button>`;
            });
            document.getElementById("options").innerHTML = optionsHtml;
        }
        document.querySelector('.next-btn').style.display = 'block';

        function checkAnswer(btn, selectedOption) {
            selected = true; // Mark that an answer has been selected
            const correctAnswer = questions[currentQuestionIndex].answer;
            if (selectedOption === correctAnswer) {
                btn.classList.add("correct");
                score++;
                showCracker();
                triggerConfetti();
            } else {
                wrongAnswersCount = Math.min(wrongAnswersCount + 1, 10); // Max 10 thumbs
                btn.classList.add("incorrect");
                showBooingHands();
                
                // Highlight correct answer
                document.querySelectorAll(".option").forEach(button => {
                    if (button.textContent === correctAnswer) {
                        button.classList.add("correct");
                    }
                });
            }
            document.querySelectorAll(".option").forEach(button => button.disabled = true);
        }

        function showCracker() {
            const cracker = document.createElement('img');
            cracker.className = 'cracker-pop';
            document.body.appendChild(cracker);
            
            setTimeout(() => {
                cracker.remove();
            }, 1500);
        }

        function showBooingHands() {
            const container = document.createElement('div');
            container.className = 'booing-container';
            document.body.appendChild(container);
            
            for (let i = 0; i < wrongAnswersCount; i++) {
                setTimeout(() => {
                    const hands = document.createElement('div');
                    hands.className = 'booing-hands';
                    hands.innerHTML = 'üëé';
                    // Random horizontal offset from center
                    hands.style.left = `calc(50% + ${(Math.random() * 200 - 100)}px)`;
                    container.appendChild(hands);
                    
                    setTimeout(() => {
                        hands.remove();
                    }, 2000);
                }, i * 150); // Stagger appearance
            }
            
            setTimeout(() => {
                container.remove();
            }, wrongAnswersCount * 150 + 2000);
        }

        function triggerConfetti() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 }
            });
        }

        function nextQuestion() {
            if (!selected) {
                alert("Please select an answer before continuing!");
                return;
            }
            
            currentQuestionIndex++;
            
            if (currentQuestionIndex < questions.length) {
                loadQuestion();
            } else {
                showFinalResults();
                document.querySelector('.next-btn').style.display = 'none';
                document.getElementById('question-counter').style.display = 'none';
            }
        }

        function showFinalResults() {
    const ghibliResults = document.getElementById('ghibli-results');
    const ghibliScore = document.getElementById('ghibli-score');
    const ghibliMessage = document.getElementById('ghibli-message');
    const ghibliChar = document.getElementById('ghibli-char');

    ghibliResults.style.display = 'block';
    ghibliScore.textContent = `${score}/10`;

    if (score === 10) {
        ghibliChar.textContent = 'üêâ';
        ghibliMessage.textContent = 'Perfect! You mastered everything!';
    } else if (score >= 7) {
        ghibliChar.textContent = 'ü¶ä';
        ghibliMessage.textContent = 'Well done! You\'re almost a master!';
    } else if (score >= 4) {
        ghibliChar.textContent = 'üêû';
        ghibliMessage.textContent = 'Great progress! Keep learning!';
    } else if (score >= 1) {
        ghibliChar.textContent = 'üå±';
        ghibliMessage.textContent = 'Everyone starts somewhere. Let\'s grow together!';
    } else {
        ghibliChar.textContent = 'üåßÔ∏è';
        ghibliMessage.textContent = 'No worries, fresh start awaits!';
    }
}
 
        window.onload = loadQuestion;
    </script>
</body>
</html>
