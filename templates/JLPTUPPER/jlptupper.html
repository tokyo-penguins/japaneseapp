<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT2~1 Quiz</title>
    <style>
        body {
  background-image: url("{{ url_for('static', filename='images/p.png') }}");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  min-height: 100vh;
  margin: 0;
  padding: 20px;
  font-family: 'Comic Sans MS', 'Noto Sans JP', cursive;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}

.quiz-container {
  background: #fff8dc;
  border: 5px solid black;
  border-radius: 20px;
  padding: 30px;
  max-width: 90%;
  box-shadow: 6px 6px 0 #000;
  position: relative;
  z-index: 1;
}

.question-counter {
  font-weight: bold;
  color: #ff4444;
  font-size: 1.2em;
  text-shadow: 1px 1px white;
  margin-bottom: 10px;
}

.option {
  background-color: #ffefc3;
  border: 3px solid black;
  border-radius: 10px;
  padding: 12px;
  margin: 8px 0;
  font-size: 16px;
  cursor: pointer;
  width: 100%;
  box-shadow: 3px 3px 0 black;
  transition: transform 0.2s, background-color 0.2s;
}

.option:hover {
  transform: scale(1.05);
  background-color: #ffe28a;
}

.correct {
  background-color: #4CAF50 !important;
  color: white;
}

.incorrect {
  background-color: #f44336 !important;
  color: white;
}

.next-btn, #back-btn {
  border: 3px solid black;
  border-radius: 12px;
  padding: 12px 20px;
  font-size: 16px;
  font-weight: bold;
  font-family: 'Comic Sans MS', cursive;
  box-shadow: 3px 3px 0 black;
  transition: transform 0.2s;
  position: fixed;
  z-index: 100;
}

.next-btn {
  background-color: #4CAF50;
  color: white;
  right: 20px;
  bottom: 20px;
  display: none; /* ÂàùÊúü„ÅØÈùûË°®Á§∫„Å´„Åó„Å¶JS„ÅßË°®Á§∫ */
}

#back-btn {
  background-color: #2196F3;
  color: white;
  left: 20px;
  bottom: 20px;
}

/* „Çπ„Éû„ÉõÁî®„É¨„Çπ„Éù„É≥„Ç∑„Éñ */
@media (max-width: 768px) {
  .quiz-container {
    width: 95%;
    padding: 20px;
  }

  .option {
    font-size: 14px;
  }

  .next-btn, #back-btn {
    padding: 10px 14px;
    font-size: 14px;
  }
}
#question-img {
  display: block;
  margin: 20px auto;
  max-width: 100%;
  height: auto;
  border-radius: 10px;
}
    </style>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>
    <div class="quiz-container">
        <div class="question-counter" id="question-counter">Question 1 of 10</div>
        <p id="question"></p>
        <img id="question-img" src="" alt="Question Image">
        <div id="options"></div>
        <div class="buttons-container">
            <button onclick="nextQuestion()" class="next-btn">Next</button>
            <button id="back-btn" onclick="window.location.href='/home#jlptup'">Back to Main Menu</button>
        </div>
        <div id="ghibli-results" class="ghibli-results" style="display:none;">
            <div class="ghibli-clouds"></div>
            <h2 class="ghibli-title">Your Quiz Results</h2>
            <div class="ghibli-character" id="ghibli-char">üêâ</div>
            <div class="ghibli-score" id="ghibli-score">0/10</div>
            <div class="ghibli-message" id="ghibli-message"></div>
            
        </div>
    </div>

    <script>
        const questions = [
            {
                question: "1. „Åì„ÅÆÂïÜÂìÅ„ÅØÔºàÔºøÔºâË≤©Â£≤„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑ„ÄÇ",
                options: ["1. „ÇÇ„ÅØ„ÇÑ", "2. „Åï„Åª„Å©", "3. „ÅÑ„Åã„Å´", "4. „ÅÑ„ÇÑ„Åó„Åè„ÇÇ"],
                answer: "1. „ÇÇ„ÅØ„ÇÑ",
                image: "{{ url_for('static', filename='images/product.png') }}",
                imageStyle: "max-height: 200px;" 
            },
            {
                question: "2. Âπ¥ÈΩ¢„ÇíËÅû„Åã„Çå„Åü„ÅÆ„ÅßÔºàÔºøÔºâ„Åó„Åü„ÄÇ",
                options: ["1. Ë®Ä„ÅÑË®≥„Çí","2. „ÅÜ„Åù„Å§„Åç", "3. ÁéâËô´Ëâ≤", "4. „ÅäËå∂„ÇíÊøÅ"],
                answer: "4. „ÅäËå∂„ÇíÊøÅ",
                image: "{{ url_for('static', filename='images/age.png') }}",
                imageStyle: "width: 200px; height: 200px; object-fit: cover;" 
            },
            {
                question: "3. What's the meaning of [„Åï„ÇÇ„Åó„ÅÑ]",
                options: ["1. „Åö„ÇãË≥¢„ÅÑ", "2. Âçë„Åó„ÅÑ", "3. „ÇÅ„Çì„Å©„Åè„Åï„ÅÑ", "4. ËªΩÁéá„Å™"],
                answer: "2. Âçë„Åó„ÅÑ",
                image: "{{ url_for('static', filename='images/samoshii.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "4. ÂΩº„ÅØÁßÅ„Åü„Å°„ÅÆÊúüÂæÖ„ÇíÔºàÔºøÔºâË£èÂàá„Å£„Åü„ÄÇ",
                options: ["1. „Åæ„Çã„Åæ„Çã„Å®", "2. „Åì„Å®„Åî„Å®„Åè", "3. „ÅÑ„ÇÑ„ÅÑ„ÇÑ„Å´", "4. „Åó„Åã„Åò„Åã„Å®"],
                answer: "2. „Åì„Å®„Åî„Å®„Åè",
                image: "{{ url_for('static', filename='images/betray.png') }}",
                imageStyle: "width: 200px; height: 200px; object-fit: cover;" 
            },
            {
                question: "5. How to read this kanji: [ÂÇ≤ÊÖ¢]",
                options: ["1. „Åî„ÅÜ„Åæ„Çì", "2. „Åç„Çá„ÅÜ„Åæ„Çì", "3. „Åì„ÅÜ„Åæ„Çì", "4. „Åî„ÅÜ„Å∞„Çì"],
                answer: "1. „Åî„ÅÜ„Åæ„Çì",
                image: "{{ url_for('static', filename='images/gouman.png') }}",
                imageStyle: "width: 200px; height: 250px;"
            },
            {
                question: "6. Âë®„Çä„ÅÆÁä∂Ê≥Å„ÇíËÄÉ„Åà„Åö„ÄÅËá™ÂàÜÂãùÊâãË°åÂãï„Åô„ÇãÊßò",
                options: ["1. Áã¨Êñ≠Â∞ÇË°å", "2. ‰ªòÂíåÈõ∑Âêå", "3. ÂÇçËã•ÁÑ°‰∫∫", "4. ÁÑ°ÊàëÂ§¢‰∏≠"],
                answer: "3. ÂÇçËã•ÁÑ°‰∫∫",
                image: "{{ url_for('static', filename='images/boujku.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "7. „Åì„Çå„Åã„Çâ„ÅØÁöÜ„Çì„Å™„ÅßÔºàÔºøÔºâÈ†ëÂºµ„Çç„ÅÜ„ÄÇ",
                options: ["1. ËÉå‰º∏„Å≥„Çí„Åó„Å¶", "2. Áõ∏„Åæ„Å£„Å¶", "3. ‰∏ÄËá¥„Åó„Å¶", "4. Ë∂≥‰∏¶„Åø„ÇíÊèÉ„Åà„Å¶"],
                answer: "4. Ë∂≥‰∏¶„Åø„ÇíÊèÉ„Åà„Å¶",
                image: "{{ url_for('static', filename='images/ashinami.png') }}",
                imageStyle: "width: 220px; height: 220px;"
            },
            {
                question: "8. ÈÉ®Èï∑„Å´‰ºù„Åà„ÇãÊôÇ„ÄÅÊúÄ„ÇÇÈÅ©Âàá„Å™„ÅÆ„ÅØ„Å©„Çå„ÅãÔºü",
                options: ["1. Áî∞‰∏≠Êßò„Åå„ÅäË∂ä„Åó„Å´„Å™„Çä„Åæ„Åó„Åü„ÄÇ", "2. Áî∞‰∏≠Êßò„ÅåÂèÇ„Çä„Åæ„Åó„Åü„ÄÇ", "3. Áî∞‰∏≠Êßò„Åå‰º∫„ÅÑ„Åæ„Åó„Åü„ÄÇ", "4. Áî∞‰∏≠Êßò„Åå„Åä„ÅÑ„Åß„Åó„Åæ„Åó„Åü„ÄÇ"],
                answer: "1. Áî∞‰∏≠Êßò„Åå„ÅäË∂ä„Åó„Å´„Å™„Çä„Åæ„Åó„Åü„ÄÇ",
                image: "{{ url_for('static', filename='images/tanaka.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "9. Ê¨∫Áûû",
                options: ["1. Ë™†ÂÆü", "2. ÁúüÂÆü", "3. „Åî„Åæ„Åã„Åó", "4. ‰ø°È†º"],
                answer: "3. „Åî„Åæ„Åã„Åó",
                image: "{{ url_for('static', filename='images/giman.png') }}",
                imageStyle: "width: 200px; height: 200px;"
            },
            {
                question: "10. „Åì„ÅÆÂ∞èË™¨„ÅØÔºàÔºøÔºâ„Å´„ÇÇÊ∑±„ÅèËÄÉ„Åà„Åï„Åõ„Çâ„Çå„ÇãÂÜÖÂÆπ„Å†„ÄÇ",
                options: ["1. „Å©„Åì„Åæ„Åß", "2. Âê¶Âøú„Å™„Åó„Å´", "3. Áõ¥Âêë„Åç„Å´", "4. „Åï„Å™„Åå„Çâ"],
                answer: "2. Âê¶Âøú„Å™„Åó„Å´",
                image: "{{ url_for('static', filename='images/book.png') }}",
                imageStyle: "width: 250px; height: 200px;"
            },
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let wrongAnswersCount = 0;
        let selected = false;
        
        function loadQuestion() {
            selected = false; // Reset selected status for new question
            const questionData = questions[currentQuestionIndex];
            document.getElementById("question").innerText = questionData.question;
            
            // Update question counter
            document.getElementById("question-counter").innerText = 
                `Question ${currentQuestionIndex + 1} of ${questions.length}`;
            
            const imgElement = document.getElementById("question-img");
            imgElement.src = questionData.image;
            imgElement.style = questionData.imageStyle || ""; 
            
            let optionsHtml = "";
            questionData.options.forEach(option => {
                optionsHtml += `<button class='option' onclick='checkAnswer(this, "${option}")'>${option}</button>`;
            });
            document.getElementById("options").innerHTML = optionsHtml;
        }
        document.querySelector('.next-btn').style.display = 'block';

        function checkAnswer(btn, selectedOption) {
            selected = true; // Mark that an answer has been selected
            const correctAnswer = questions[currentQuestionIndex].answer;
            if (selectedOption === correctAnswer) {
                btn.classList.add("correct");
                score++;
                showCracker();
                triggerConfetti();
            } else {
                wrongAnswersCount = Math.min(wrongAnswersCount + 1, 10); // Max 10 thumbs
                btn.classList.add("incorrect");
                showBooingHands();
                
                // Highlight correct answer
                document.querySelectorAll(".option").forEach(button => {
                    if (button.textContent === correctAnswer) {
                        button.classList.add("correct");
                    }
                });
            }
            document.querySelectorAll(".option").forEach(button => button.disabled = true);
        }

        function showCracker() {
            const cracker = document.createElement('img');
            cracker.className = 'cracker-pop';
            document.body.appendChild(cracker);
            
            setTimeout(() => {
                cracker.remove();
            }, 1500);
        }

        function showBooingHands() {
            const container = document.createElement('div');
            container.className = 'booing-container';
            document.body.appendChild(container);
            
            for (let i = 0; i < wrongAnswersCount; i++) {
                setTimeout(() => {
                    const hands = document.createElement('div');
                    hands.className = 'booing-hands';
                    hands.innerHTML = 'üëé';
                    // Random horizontal offset from center
                    hands.style.left = `calc(50% + ${(Math.random() * 200 - 100)}px)`;
                    container.appendChild(hands);
                    
                    setTimeout(() => {
                        hands.remove();
                    }, 2000);
                }, i * 150); // Stagger appearance
            }
            
            setTimeout(() => {
                container.remove();
            }, wrongAnswersCount * 150 + 2000);
        }

        function triggerConfetti() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 }
            });
        }

        function nextQuestion() {
            if (!selected) {
                alert("Please select an answer before continuing!");
                return;
            }
            
            currentQuestionIndex++;
            
            if (currentQuestionIndex < questions.length) {
                loadQuestion();
            } else {
                showFinalResults();
                document.querySelector('.next-btn').style.display = 'none';
                document.getElementById('question-counter').style.display = 'none';
            }
        }

        function showFinalResults() {
    const ghibliResults = document.getElementById('ghibli-results');
    const ghibliScore = document.getElementById('ghibli-score');
    const ghibliMessage = document.getElementById('ghibli-message');
    const ghibliChar = document.getElementById('ghibli-char');

    ghibliResults.style.display = 'block';
    ghibliScore.textContent = `${score}/10`;

    if (score === 10) {
        ghibliChar.textContent = 'üêâ';
        ghibliMessage.textContent = 'Perfect! You mastered everything!';
    } else if (score >= 7) {
        ghibliChar.textContent = 'ü¶ä';
        ghibliMessage.textContent = 'Well done! You\'re almost a master!';
    } else if (score >= 4) {
        ghibliChar.textContent = 'üêû';
        ghibliMessage.textContent = 'Great progress! Keep learning!';
    } else if (score >= 1) {
        ghibliChar.textContent = 'üå±';
        ghibliMessage.textContent = 'Everyone starts somewhere. Let\'s grow together!';
    } else {
        ghibliChar.textContent = 'üåßÔ∏è';
        ghibliMessage.textContent = 'No worries, fresh start awaits!';
    }
}
 
        window.onload = loadQuestion;
    </script>
</body>
</html>
